# Internationalization (i18n)

## Overview

Using Flutter's official localization system:
- `flutter_localizations` - Framework translations
- `intl` - Date/number formatting
- ARB files - App string translations

## Configuration

### pubspec.yaml
```yaml
dependencies:
  flutter_localizations:
    sdk: flutter
  intl: ^0.18.0

flutter:
  generate: true
```

### l10n.yaml
```yaml
arb-dir: lib/l10n
template-arb-file: app_en.arb
output-localization-file: app_localizations.dart
output-class: AppLocalizations
```

## ARB File Format

Location: `lib/l10n/app_<locale>.arb`

### Template (English)
```json
{
  "@@locale": "en",

  "appTitle": "Meteogram",
  "@appTitle": {
    "description": "App name shown in title bar and widget"
  },

  "temperature": "Temperature",
  "@temperature": {
    "description": "Label for temperature axis on chart"
  },

  "precipitation": "Precipitation",
  "@precipitation": {
    "description": "Label for precipitation data on chart"
  },

  "updatedAt": "Updated {time}",
  "@updatedAt": {
    "description": "Shows when data was last refreshed",
    "placeholders": {
      "time": {
        "type": "String",
        "example": "5 min ago"
      }
    }
  },

  "temperatureValue": "{value}Â°",
  "@temperatureValue": {
    "description": "Formatted temperature with degree symbol",
    "placeholders": {
      "value": {
        "type": "String",
        "example": "23"
      }
    }
  },

  "precipitationMm": "{value} mm",
  "@precipitationMm": {
    "description": "Precipitation in millimeters",
    "placeholders": {
      "value": {
        "type": "String",
        "example": "2.5"
      }
    }
  },

  "noConnection": "No internet connection",
  "@noConnection": {
    "description": "Error shown when network is unavailable"
  },

  "locationUnavailable": "Location unavailable",
  "@locationUnavailable": {
    "description": "Error when GPS/location cannot be determined"
  },

  "refresh": "Refresh",
  "@refresh": {
    "description": "Button to manually refresh weather data"
  },

  "settings": "Settings",
  "@settings": {
    "description": "Settings screen title"
  }
}
```

## Supported Locales

| Code | Language | File |
|------|----------|------|
| en | English | app_en.arb |
| de | German | app_de.arb |
| fr | French | app_fr.arb |
| es | Spanish | app_es.arb |
| it | Italian | app_it.arb |

## Usage in Code

### Setup in main.dart
```dart
import 'package:flutter_gen/gen_l10n/app_localizations.dart';

MaterialApp(
  localizationsDelegates: AppLocalizations.localizationsDelegates,
  supportedLocales: AppLocalizations.supportedLocales,
  ...
)
```

### Accessing strings
```dart
// In widget build method
final l10n = AppLocalizations.of(context)!;

Text(l10n.temperature);
Text(l10n.updatedAt('5 min ago'));
Text(l10n.temperatureValue('23'));
```

## Adding a New Language

1. Create `lib/l10n/app_<code>.arb`
2. Copy content from `app_en.arb`
3. Change `"@@locale": "<code>"`
4. Translate all strings (keep `@` metadata unchanged)
5. Run `flutter gen-l10n`

## Translation Guidelines

- Keep translations concise (widget space is limited)
- Use informal tone (du/tu, not Sie/vous)
- Preserve placeholders exactly: `{value}`, `{time}`
- Test with longest expected translation (German often longest)

## Locale-Based Units

Units are NOT translated strings - they're determined by locale:

```dart
class UnitsService {
  bool usesFahrenheit(Locale locale) {
    // US, Liberia, Myanmar use Fahrenheit
    return ['US', 'LR', 'MM'].contains(locale.countryCode);
  }

  bool usesInches(Locale locale) {
    return ['US', 'GB'].contains(locale.countryCode);
  }
}
```

## Date/Time Formatting

Use `intl` package for locale-aware formatting:

```dart
import 'package:intl/intl.dart';

// Hour format based on locale
DateFormat.Hm(locale).format(dateTime);  // 14:30 or 2:30 PM
```
